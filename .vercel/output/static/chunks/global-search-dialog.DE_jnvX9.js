import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r}from"./index.WFquGv8Z.js";import{r as N}from"./lazy-search-dialog.D7UquGDy.js";import{f as S,F as E}from"./search-service.C9HhnvYq.js";import{f as D}from"./date-utils.CT4EJ0jl.js";import"./index.ZX95bEFL.js";function T({locale:x="en",labels:i}){const[m,a]=r.useState(!1),[l,v]=r.useState(""),[n,f]=r.useState([]),[d,p]=r.useState(!1),[y,w]=r.useState([]),[c,u]=r.useState(-1),h=r.useRef(null),b=r.useRef(null);r.useEffect(()=>{const t=o=>{(o.metaKey||o.ctrlKey)&&o.key==="k"&&(o.preventDefault(),a(!0)),o.key==="Escape"&&a(!1)},s=()=>a(!0);return window.addEventListener("keydown",t),window.addEventListener("open-global-search",s),()=>{window.removeEventListener("keydown",t),window.removeEventListener("open-global-search",s)}},[]),r.useEffect(()=>{m&&(setTimeout(()=>b.current?.focus(),100),u(-1),y.length===0&&!d&&j())},[m]);const j=async()=>{p(!0);const t=await S(x);w(t),h.current=new E(t,{keys:["title"],threshold:.3,includeScore:!0}),p(!1)};r.useEffect(()=>{if(!l||!h.current){f([]);return}const t=h.current.search(l);f(t.map(s=>s.item).slice(0,8))},[l]);const k=t=>{if(n.length!==0){if(t.key==="ArrowDown")t.preventDefault(),u(s=>(s+1)%n.length);else if(t.key==="ArrowUp")t.preventDefault(),u(s=>(s-1+n.length)%n.length);else if(t.key==="Enter"&&(t.preventDefault(),c!==-1)){const s=n[c];if(s){const o=document.querySelector(`a[href="${g}/blog/${s.slug}"]`);o&&o.click(),a(!1)}}}};if(!m)return null;const g=x==="pt_BR"?"/br":"";return N.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-start justify-center pt-[15vh] px-4 font-sans text-text-main",children:[e.jsx("div",{className:"absolute inset-0 bg-bg-main/80 backdrop-blur-sm transition-opacity",onClick:()=>a(!1)}),e.jsxs("div",{className:"relative w-full max-w-2xl bg-bg-card border border-border rounded-xl shadow-2xl overflow-hidden animate-fade-in-up",children:[e.jsxs("div",{className:"flex items-center border-b border-border p-4",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 text-text-muted mr-3",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),e.jsx("input",{ref:b,type:"text",value:l,onChange:t=>v(t.target.value),onKeyDown:k,placeholder:i.placeholder,className:"flex-1 bg-transparent border-none outline-none text-lg text-text-main placeholder-text-muted h-10"}),e.jsxs("button",{onClick:()=>a(!1),className:"p-2 ml-2 text-text-muted hover:text-text-main hover:bg-bg-elevated rounded-md transition-colors",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("kbd",{className:"hidden md:inline-block px-2 py-0.5 text-xs font-mono bg-bg-elevated rounded border border-border",children:"ESC"}),e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 md:hidden",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})]})]}),e.jsxs("div",{className:"max-h-[60vh] overflow-y-auto",children:[d&&e.jsxs("div",{className:"p-8 text-center text-text-muted",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-2"}),i.loadingText]}),!d&&l.length>0&&n.length===0&&e.jsxs("div",{className:"p-12 text-center text-text-muted",children:[e.jsx("p",{className:"font-medium mb-1",children:i.emptyTitle}),e.jsx("p",{className:"text-sm",children:i.emptyText})]}),!d&&l.length===0&&e.jsx("div",{className:"p-12 text-center text-text-muted",children:e.jsx("p",{className:"text-sm",children:i.initialText})}),n.length>0&&e.jsx("ul",{className:"divide-y divide-border/50",children:n.map((t,s)=>e.jsx("li",{children:e.jsxs("a",{href:`${g}/blog/${t.slug}`,className:`block p-4 transition-colors group ${s===c?"bg-primary/10 border-l-4 border-primary":"hover:bg-bg-elevated border-l-4 border-transparent"}`,onClick:()=>a(!1),children:[e.jsx("h4",{className:`font-bold text-lg transition-colors ${s===c?"text-primary":"text-text-main group-hover:text-primary"}`,children:t.title}),e.jsx("span",{className:"text-xs text-text-muted mt-1 block",children:t.type==="blog"&&t.published_at?D(t.published_at,x):""})]})},t.slug))})]})]})]}),document.body)}export{T as default};

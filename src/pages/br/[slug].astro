---
import Layout from '../../layouts/layout.astro'
import Header from '../../components/header.astro'
import Footer from '../../components/footer.astro'
import Container from '../../components/ui/container.astro'
import BlockRenderer from '../../components/blocks/block-renderer.astro'
import { rush } from '../../lib/rush'
import { homeContent } from "../../content/home";

// Use PT_BR content
const content = homeContent.pt_BR;

export async function getStaticPaths() {
	try {
        // ID 2 is the 'Pages' collection
		const response = await rush.getEntries(2)
		const pages = response.data

		return pages.map((page) => ({
			params: { slug: page.slug },
			props: { page }
		}))
	} catch (error) {
		console.error('Error fetching paths for link pages:', error)
		return []
	}
}

interface Props {
	page: {
		slug: string
		title: string
		content?: string
		data?: {
			content?: Array<{
				type: string
				data: Record<string, any>
			}>
		}
	}
}

const { page } = Astro.props

const title = `${page.title} | Rafhael Marsigli`
const description = page.content?.substring(0, 160) || `${page.title} - Rafhael Marsigli`
---

<Layout title={title} description={description}>
	<Header content={content.global.nav} locale="pt_BR" />
	
	<main class='pt-24'>
		<article>
			<Container className='max-w-4xl mb-24'>
				<h1
					class='font-serif text-primary text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold leading-tight mb-12'
				>
					{page.title}
				</h1>

				<div
					class='prose prose-invert prose-lg lg:prose-xl xl:prose-2xl max-w-none prose-headings:font-serif prose-headings:font-bold prose-headings:text-primary prose-a:text-primary prose-a:no-underline hover:prose-a:underline prose-img:rounded-2xl'
				>
					{
						page.data?.content && page.data.content.length > 0 ? (
							<BlockRenderer blocks={page.data.content} />
						) : (
							<div set:html={page.content} />
						)
					}
				</div>
			</Container>
		</article>
	</main>

	<Footer content={content.global.footer} />
</Layout>

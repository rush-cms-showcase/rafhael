---
import Layout from "../../layouts/layout.astro";
import Header from "../../components/header.astro";
import Footer from "../../components/footer.astro";
import Section from "../../components/ui/section.astro";
import Container from "../../components/ui/container.astro";
import BlogSearch from "../../components/blog/blog-search.tsx";
import { rush, type BlogPost } from "../../lib/rush";

// Fetch posts from CMS
let posts: BlogPost[] = [];
try {
    const response = await rush.getEntries("blog", {
        per_page: 1000,
    });
    posts = response.data as unknown as BlogPost[];
} catch (error) {
    console.error("Error fetching blog posts:", error);
    posts = [];
}

const title = "Blog - Rafhael Marsigli";
const description =
    "Artigos sobre performance web, SEO e estratégias digitais para arquitetos e empresas de alto padrão.";
---

<Layout title={title} description={description}>
    <Header />
    <main class="pt-16 md:pt-12">
        <Section>
            <Container>
                <div class="text-center">
                    <h2
                        class="text-primary text-4xl lg:text-6xl font-bold mb-8"
                    >
                        Blog
                    </h2>
                </div>
                <BlogSearch client:load initialPosts={posts} />
            </Container>
        </Section>
    </main>
    <Footer />
</Layout>

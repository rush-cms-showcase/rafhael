---
import Layout from "../../layouts/layout.astro";
import Header from "../../components/header.astro";
import Footer from "../../components/footer.astro";
import Section from "../../components/ui/section.astro";
import Container from "../../components/ui/container.astro";
import BlogSearch from "../../components/blog/blog-search.tsx";
import { rush, type BlogPost } from "../../lib/rush";
import { homeContent } from "../../content/home";

// Use English content
const content = homeContent.en;

// Fetch posts from CMS
let posts: BlogPost[] = [];
try {
    const response = await rush.getEntries("blog", {
        per_page: 1000,
        include: 'featured_image',
        locale: 'en'
    });
    posts = (response as any).data as BlogPost[];
} catch (error) {
    console.error("Error fetching blog posts:", error);
    posts = [];
}

const title = "Blog - Rafhael Marsigli";
const description =
    "Artigos sobre performance web, SEO e estratégias digitais para arquitetos e empresas de alto padrão.";
---

<Layout title="Blog | Rafhael Marsigli" description="Articles about software development, architecture and technology.">
    <Header content={content.global.nav} locale="en" />
    <main class="pt-16 md:pt-12">
        <Section>
            <Container>
                <div class="text-center">
                    <h2
                        class="text-primary text-4xl lg:text-6xl font-bold mb-8"
                    >
                        Blog
                    </h2>
                </div>
                <BlogSearch 
                    client:load 
                    initialPosts={posts} 
                    labels={content.blog} 
                    taxonomies={content.taxonomies}
                />
            </Container>
        </Section>
    </main>
    <Footer content={content.global.footer} />
</Layout>
